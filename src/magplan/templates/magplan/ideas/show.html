{% extends "layout_plan.html" %}
{% block title %}–ò–¥–µ—è ¬´{{ idea.title }}¬ª{% endblock %}
{% load filters %}
{% block styles %}
{% endblock %}
{% block content %}
    <h2 id='title' class="text-muted">{{ idea.title }}</h2>
    <p>
        <strong>–ü—Ä–µ–¥–ª–æ–∂–∏–ª</strong> {{ idea.editor }}
    </p>
    <p>
        {% with idea=idea AUTHOR_TYPE_CHOICES=AUTHOR_TYPE_CHOICES %}
            {% include 'magplan/ideas/_authors_list.html' %}
        {% endwith %}
    </p>
    <div id="description">{{ idea.description_html|safe }}</div>

    {% if idea.approved is None %}
        {% include 'magplan/ideas/_vote.html' %}
    {% else %}
        <br>

        {% if idea.approved == True %}
            <h2 style="padding-bottom: 0.6rem;"><strong>–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏–¥–µ—è —Å—Ç–∞—Ç—å–∏ –æ–¥–æ–±—Ä–µ–Ω–∞! üëç üòä üöÄ</strong></h2>
            <div class="row">
                {% include 'magplan/ideas/_voting_results.html' %}
            </div>
            <br>
            <div class="card border-success">
                {% if idea.post %}
                    <div class="card-header text-white bg-primary">–ï—Å—Ç—å —Å—Ç–∞—Ç—å—è!</div>
                    <div class="card-body"> –ö —ç—Ç–æ–π –∏–¥–µ–µ —Å–æ–∑–¥–∞–Ω–∞ —Å—Ç–∞—Ç—å—è:
                        <a class="btn btn-secondary btn-sm" href="{% url 'posts_show' idea.post.id %}">–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å</a>
                    </div>
                {% else %}
                    <div class="card-header text-white bg-success">–°–¥–µ–ª–∞—Ç—å –∏–∑ –∏–¥–µ–∏ —Å—Ç–∞—Ç—å—é</div>
                    <div class="card-body text-success">
                        <form action="{% url 'posts_create' %}" method="POST" accept-charset="utf-8">
                            {% csrf_token %}
                            {% include 'magplan/posts/_form_base.html' %}
                            <input type="hidden" name="idea_id" value="{{ idea.id }}"/>
                            <button type="submit" class="btn btn-success float-right">–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é –∏–∑ –∏–¥–µ–∏!</button>
                        </form>
                    </div>
                {% endif %}


            </div>
        {% else %}
            <h2 style="padding-bottom: 0.6rem;">–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏–¥–µ—è —Å—Ç–∞—Ç—å–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ ‚ùå üòµ ‚õà</h2>
            <p>–°–¥–µ–ª–∞—Ç—å –∏–∑ –Ω–µ–µ —Å—Ç–∞—Ç—å—é –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–µ–ª—å–∑—è.</p>
            <div class="row">
                {% include 'magplan/ideas/_voting_results.html' %}
            </div>
        {% endif %}
    {% endif %}
    <br/>

    {# Support for generic comments template #}
    {% with comments=idea.comments_ form=comment_form action_url=idea|url_for_idea_comments %}
        {% include 'magplan/partials/comments.html' %}
    {% endwith %}

{% endblock %}
{% block scripts %}
    <script type="text/javascript">
        $('.issues-suggestions .suggestion a').click(function (e) {
            e.preventDefault()
            let id = $(this).data('id')

            $('#id_issues').val(id).trigger('change');
        })
    </script>
{% endblock %}
